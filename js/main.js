"use strict";let list=document.querySelector(".list > ul"),form=document.querySelector(".form"),formInput=form.elements[0],btn=document.querySelector(".form > button"),legend=document.querySelector(".legenda"),noTask=document.querySelector(".list .noTaskMsg");function addTask(){var e=form.elements[0].value;let t=document.createElement("li");t.className="task";var l=list.childNodes.length+1;t.setAttribute("id",l);const r=' \n    <span class="prioridade">'.concat(t.getAttribute("id"),'</span> \n    <span class="descricao" contenteditable>').concat(e,'</span>\n    <div class="controls">\n      <div class="clone"><img src="./img/duplicate.png"></div>\n      <div class="plus"><img src="./img/plus.png"></div>\n      <div class="minus"><img src="./img/minus.png"></div>\n      <div class="delete"><img src="./img/bin.png"></div>\n    </div>');t.innerHTML=r.trim(),list.appendChild(t),listeners(),form.reset()}function listeners(){const e=document.querySelectorAll(".delete"),t=document.querySelectorAll(".minus"),l=document.querySelectorAll(".plus"),r=document.querySelectorAll(".clone");e.forEach(e=>{e.addEventListener("click",removeTask)}),t.forEach(e=>{e.addEventListener("click",lessPriority)}),l.forEach(e=>{e.addEventListener("click",morePriority)}),r.forEach(e=>{e.addEventListener("click",cloneTask)})}function cloneTask(){let e=this.parentNode.parentNode,t=e.cloneNode(!0);var l=document.querySelector(".list > ul").childNodes.length+1;t.children[0].textContent=l,t.setAttribute("id",l),e.after(t),showModal("Tarefa duplicada")}btn.addEventListener("click",e=>{e.preventDefault();e=document.querySelector(".list > ul");addTask(),showModal("Uma tarefa adicionada"),0!==e.children&&(legend.classList.add("active"),noTask.classList.add("hide")),btn.setAttribute("disabled",!0)}),formInput.addEventListener("blur",()=>{""==formInput.value&&btn.setAttribute("disabled",!0)}),formInput.addEventListener("keyup",()=>{btn.removeAttribute("disabled")});const modal=document.querySelector(".modal");function showModal(e){modal.textContent=e,modal.classList.add("activeModal"),setTimeout(()=>{modal.classList.remove("activeModal")},2e3)}let total=document.querySelector(".pendentes"),tasksList=document.querySelector(".list > ul"),noTaskMsg=document.querySelector(".list .noTaskMsg"),observer=new MutationObserver(e=>{total.textContent=tasksList.childNodes.length;const t=document.querySelectorAll(".delete"),l=document.querySelectorAll(".minus"),r=document.querySelectorAll(".plus"),o=document.querySelectorAll(".clone");t.forEach(e=>{e.addEventListener("click",removeTask)}),l.forEach(e=>{e.addEventListener("click",lessPriority)}),r.forEach(e=>{e.addEventListener("click",morePriority)}),o.forEach(e=>{e.addEventListener("click",cloneTask)}),alterId(),updateId()});observer.observe(tasksList,{childList:!0});let observerId=new MutationObserver(e=>{console.log("mudou"),updateId()});function updateId(){tasksList.childNodes.forEach(e=>{e.childNodes[0].textContent=e.getAttribute("id")})}function lessPriority(){var e=document.querySelector(".list > ul"),t=this.parentNode.parentNode;let l=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null,!1),r=l.firstChild();for(;r!==t;)r=l.nextSibling();r=l.nextSibling(),null!==r&&r.after(t),alterId()}function morePriority(){var e=document.querySelector(".list > ul");let t=this.parentNode.parentNode,l=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null,!1),r=l.firstChild();for(;r!==t;)r=l.nextSibling();r=l.previousSibling(),null!==r&&(t.classList.add("subir"),r.before(t)),t.classList.remove("subir"),alterId()}function alterId(){let e=tasksList.childNodes;e.forEach((e,t)=>{e.setAttribute("id",t+1)})}function removeTask(){let e=document.querySelector(".list > ul"),t=this.parentNode.parentNode;t.classList.add("remove"),setTimeout(()=>{if(e.removeChild(t),!e.childNodes.length){let e=document.querySelector(".legenda"),t=document.querySelector(".noTaskMsg");e.classList.remove("active"),t.classList.remove("hide")}},300),showModal("Tarefa removida")}observerId.observe(tasksList,{attributeFilter:["id"],subtree:!0});